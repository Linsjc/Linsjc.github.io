---
layout: post
title: 攻防世界-Reverse
date: 2020-11-25
tags: 学习日志-wp
---

## 新手区

### **insanity**

首先用**Exeinfo PE**查壳

![](/images/post/202011281.jpg)

没有壳，用IDA打开，shift+F12直接就可以看见flag.

![](/images/post/20201129100039.jpg)

### **game**

![](/images/post/20201129100643.jpg)

试了试，好像只要输入1-8就行，不需要什么顺序。

用IDA打开，shift+F12

![](/images/post/20201129101402.jpg)

双击`.rdata:0050B0F0	00000015	C	done!!! the flag is `

F5查看伪函数，上面都是一大串的char函数和v=...，最下面有个代码比较特别

```C
 for ( i = 0; i < 56; ++i )
  {
    *(&v2 + i) ^= *(&v59 + i);
    *(&v2 + i) ^= 0x13u;
  }
  return sub_45A7BE("%s\n");
}
```
用**python**写个脚本

```python
a[123,32,18,98,119,108,65,41,124,80,125,38,124,111,74,49,83,108,94,108,84,6,96,83,44,121,104,110,32,95,117,101,99,123,127,119,96,48,107,71,92,29,81,107,90,85,64,12,43,76,86,13,114,1,117,126,0]

b[18,64,98,5,2,4,6,3,6,48,49,65,32,12,48,65,31,78,62,32,49,32,1,57,96,3,21,9,4,62,3,5,4,1,2,3,44,65,78,32,16,97,54,16,44,52,32,64,89,45,32,65,15,34,18,16,0]

for i in range(57):
    a[i]=a[i]^b[i]
    a[i]=a[i]^19
    print(chr(a[i]),end='')
```

输出得到`zsctf{T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t}`